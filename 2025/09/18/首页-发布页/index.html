<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>首页/发布页 | ggbond个人博客</title><meta name="author" content="ggbond11"><meta name="copyright" content="ggbond11"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="首页&#x2F;发布页 1.双列瀑布流布局安装依赖：npm install @react-native-seoul&#x2F;masonry-list 1.1MasonryList 简介MasonryList 是一个 React Native 组件库（如 @react-native-seoul&#x2F;masonry-list），用于实现类似瀑布流（Masonry Layout）的列表展示。它的特点是：  支持多列">
<meta property="og:type" content="article">
<meta property="og:title" content="首页&#x2F;发布页">
<meta property="og:url" content="https://ggbond11.github.io/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/index.html">
<meta property="og:site_name" content="ggbond个人博客">
<meta property="og:description" content="首页&#x2F;发布页 1.双列瀑布流布局安装依赖：npm install @react-native-seoul&#x2F;masonry-list 1.1MasonryList 简介MasonryList 是一个 React Native 组件库（如 @react-native-seoul&#x2F;masonry-list），用于实现类似瀑布流（Masonry Layout）的列表展示。它的特点是：  支持多列">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ggbond11.github.io/images/ggbond.jpg">
<meta property="article:published_time" content="2025-09-18T08:02:44.000Z">
<meta property="article:modified_time" content="2025-09-18T08:04:10.147Z">
<meta property="article:author" content="ggbond11">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ggbond11.github.io/images/ggbond.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "首页/发布页",
  "url": "https://ggbond11.github.io/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/",
  "image": "https://ggbond11.github.io/images/ggbond.jpg",
  "datePublished": "2025-09-18T08:02:44.000Z",
  "dateModified": "2025-09-18T08:04:10.147Z",
  "author": [
    {
      "@type": "Person",
      "name": "ggbond11",
      "url": "https://ggbond11.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ggbond11.github.io/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '首页/发布页',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ggbond个人博客</span></a><a class="nav-page-title" href="/"><span class="site-name">首页/发布页</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">首页/发布页</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-18T08:02:44.000Z" title="发表于 2025-09-18 16:02:44">2025-09-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-18T08:04:10.147Z" title="更新于 2025-09-18 16:04:10">2025-09-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RN%E5%BC%80%E5%8F%91%E5%B0%8F%E7%B2%89%E4%B9%A6%E8%AE%B0%E5%BD%95/">RN开发小粉书记录</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>首页&#x2F;发布页</p>
<h1 id="1-双列瀑布流布局"><a href="#1-双列瀑布流布局" class="headerlink" title="1.双列瀑布流布局"></a>1.双列瀑布流布局</h1><p>安装依赖：<code>npm install @react-native-seoul/masonry-list</code></p>
<h2 id="1-1MasonryList-简介"><a href="#1-1MasonryList-简介" class="headerlink" title="1.1MasonryList 简介"></a>1.1MasonryList 简介</h2><p><code>MasonryList</code> 是一个 React Native 组件库（如 <code>@react-native-seoul/masonry-list</code>），用于实现类似瀑布流（Masonry Layout）的列表展示。它的特点是：</p>
<ul>
<li>支持多列（<code>numColumns</code>），每列高度自适应，内容像“砖块”一样错落排列。</li>
<li>适合展示图片、卡片等高度不一的内容，常见于小红书、Pinterest 等应用。</li>
<li>性能优良，支持大数据量虚拟滚动。</li>
</ul>
<h3 id="1-2在本项目中的运用"><a href="#1-2在本项目中的运用" class="headerlink" title="1.2在本项目中的运用"></a>1.2在本项目中的运用</h3><p>在你的项目（HomeScreen.tsx）中，<code>MasonryList</code> 主要用于首页内容区域的瀑布流展示：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">MasonryList</span></span><br><span class="line">  data=&#123;posts&#125;</span><br><span class="line">  keyExtractor=&#123;<span class="function">(<span class="params"><span class="attr">item</span>: <span class="title class_">Post</span></span>) =&gt;</span> item.<span class="property">id</span>.<span class="title function_">toString</span>()&#125;</span><br><span class="line">  numColumns=&#123;<span class="number">2</span>&#125;</span><br><span class="line">  contentContainerStyle=&#123;styles.<span class="property">content</span>&#125;</span><br><span class="line">  showsVerticalScrollIndicator=&#123;<span class="literal">true</span>&#125;</span><br><span class="line">  renderItem=&#123;<span class="function">(<span class="params">&#123; item &#125;: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 渲染每个帖子卡片，支持图片和文字</span></span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<p><strong>具体作用：</strong></p>
<ul>
<li><code>data=&#123;posts&#125;</code>：传入帖子数据数组。</li>
<li><code>numColumns=&#123;2&#125;</code>：设置为2列瀑布流。</li>
<li><code>renderItem</code>：自定义每个卡片的渲染方式，支持图片、标题、摘要等。</li>
<li><code>contentContainerStyle</code>：自定义内容区样式，保证左右留白和顶部间距。</li>
<li>在 Web 端和移动端都能自适应高度，实现内容错落有致的排列和流畅滚动。</li>
</ul>
<h1 id="2-发布页面"><a href="#2-发布页面" class="headerlink" title="2.发布页面"></a>2.发布页面</h1><h2 id="2-1向首页传递帖子数据"><a href="#2-1向首页传递帖子数据" class="headerlink" title="2.1向首页传递帖子数据"></a>2.1向首页传递帖子数据</h2><ul>
<li>首页跳转发布页时传递 onPublish 回调。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 跳转发布页时传递回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleGoPostEditor</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    navigation.<span class="title function_">navigate</span>(<span class="string">&#x27;PostEditor&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">onPublish</span>: <span class="title function_">async</span> (<span class="attr">post</span>: &#123; <span class="attr">title</span>: <span class="built_in">string</span>; <span class="attr">text</span>: <span class="built_in">string</span>; <span class="attr">images</span>: <span class="built_in">string</span>[] &#125;) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> newPost = &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">          <span class="attr">title</span>: post.<span class="property">title</span> || <span class="string">&#x27;新发布&#x27;</span>,</span><br><span class="line">          <span class="attr">summary</span>: post.<span class="property">text</span> || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          <span class="attr">images</span>: post.<span class="property">images</span> || []</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">addPost</span>(newPost);</span><br><span class="line">        <span class="title function_">setPosts</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [newPost, ...prev]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>发布页发布时调用 onPublish 并 goBack，数据回传并插入首页列表。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布帖子</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handlePublish</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!title.<span class="title function_">trim</span>() &amp;&amp; !text.<span class="title function_">trim</span>() &amp;&amp; images.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&#x27;请输入标题、内容或添加图片&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 回调传递数据</span></span><br><span class="line">    <span class="keyword">if</span> (route.<span class="property">params</span> &amp;&amp; <span class="keyword">typeof</span> route.<span class="property">params</span>.<span class="property">onPublish</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      route.<span class="property">params</span>.<span class="title function_">onPublish</span>(&#123; title, text, images &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    navigation.<span class="title function_">goBack</span>();</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
<h2 id="2-2发帖支持本地相册和拍照图片上传"><a href="#2-2发帖支持本地相册和拍照图片上传" class="headerlink" title="2.2发帖支持本地相册和拍照图片上传"></a>2.2发帖支持本地相册和拍照图片上传</h2><p>安装依赖：<code>npm install expo-image-picker</code></p>
<p><code>ImagePicker</code> 是 Expo 提供的一个图片&#x2F;视频选择与拍照库（expo-image-picker），用于在 React Native 应用中实现从相册选择图片或调用摄像头拍照的功能。</p>
<h3 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h3><ul>
<li>打开系统相册选择图片或视频</li>
<li>调用摄像头拍照或录像</li>
<li>支持多选、压缩、裁剪等参数</li>
<li>兼容 iOS、Android、Web</li>
</ul>
<h3 id="在本项目中的使用"><a href="#在本项目中的使用" class="headerlink" title="在本项目中的使用"></a>在本项目中的使用</h3><p>在你的 PostEditorScreen.tsx 文件中，<code>ImagePicker</code> 主要用于发帖时选择图片或拍照：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">ImagePicker</span> <span class="keyword">from</span> <span class="string">&#x27;expo-image-picker&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择图片</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">pickImage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">ImagePicker</span>.<span class="title function_">launchImageLibraryAsync</span>(&#123;</span><br><span class="line">    <span class="attr">mediaTypes</span>: <span class="title class_">ImagePicker</span>.<span class="property">MediaTypeOptions</span>.<span class="property">Images</span>,</span><br><span class="line">    <span class="attr">allowsMultipleSelection</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">quality</span>: <span class="number">0.8</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (!result.<span class="property">canceled</span> &amp;&amp; result.<span class="property">assets</span>) &#123;</span><br><span class="line">    <span class="title function_">setImages</span>([...images, ...result.<span class="property">assets</span>.<span class="title function_">map</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">uri</span>)]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拍照</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">takePhoto</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">ImagePicker</span>.<span class="title function_">launchCameraAsync</span>(&#123;</span><br><span class="line">    <span class="attr">quality</span>: <span class="number">0.8</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (!result.<span class="property">canceled</span> &amp;&amp; result.<span class="property">assets</span>) &#123;</span><br><span class="line">    <span class="title function_">setImages</span>([...images, ...result.<span class="property">assets</span>.<span class="title function_">map</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">uri</span>)]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="具体说明"><a href="#具体说明" class="headerlink" title="具体说明"></a>具体说明</h4><ul>
<li><code>launchImageLibraryAsync</code>：打开系统相册，允许多选图片，设置图片压缩质量。</li>
<li><code>launchCameraAsync</code>：调用摄像头拍照，设置图片压缩质量。</li>
<li>选择或拍照后，将图片的 <code>uri</code> 存入 <code>images</code> 状态，供发帖时展示和上传。</li>
</ul>
<h1 id="3-踩坑记录"><a href="#3-踩坑记录" class="headerlink" title="3.踩坑记录"></a>3.踩坑记录</h1><h2 id="3-1web端底部导航栏消失"><a href="#3-1web端底部导航栏消失" class="headerlink" title="3.1web端底部导航栏消失"></a>3.1web端底部导航栏消失</h2><p>在测试的过程中发现，底部导航栏在android手机上能正常显示，web端直接消失。查看dom发现由于定位的问题，在web端该导航栏跑到内容区的下面去了，而内容区又是一个很长的滚动列表，导致导航栏不可见。</p>
<p>解决办法：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tabBar</span>: &#123;</span><br><span class="line">  <span class="attr">flexDirection</span>: <span class="string">&#x27;row&#x27;</span>,</span><br><span class="line">  <span class="attr">backgroundColor</span>: <span class="variable constant_">COLORS</span>.<span class="property">primary</span>,</span><br><span class="line">  <span class="attr">height</span>: <span class="number">56</span>,</span><br><span class="line">  <span class="attr">alignItems</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">  <span class="attr">justifyContent</span>: <span class="string">&#x27;space-around&#x27;</span>,</span><br><span class="line">  <span class="comment">// 兼容 web 端底部固定</span></span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Platform</span>.<span class="property">OS</span> === <span class="string">&#x27;web&#x27;</span> ? <span class="string">&#x27;fixed&#x27;</span> : <span class="string">&#x27;absolute&#x27;</span>,</span><br><span class="line">  <span class="attr">left</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">right</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">bottom</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">borderTopLeftRadius</span>: <span class="number">12</span>,</span><br><span class="line">  <span class="attr">borderTopRightRadius</span>: <span class="number">12</span>,</span><br><span class="line">  <span class="attr">shadowColor</span>: <span class="variable constant_">COLORS</span>.<span class="property">cardShadow</span>,</span><br><span class="line">  <span class="attr">shadowOffset</span>: &#123; <span class="attr">width</span>: <span class="number">0</span>, <span class="attr">height</span>: -<span class="number">2</span> &#125;,</span><br><span class="line">  <span class="attr">shadowOpacity</span>: <span class="number">0.08</span>,</span><br><span class="line">  <span class="attr">shadowRadius</span>: <span class="number">8</span>,</span><br><span class="line">  <span class="attr">elevation</span>: <span class="number">8</span>,</span><br><span class="line">  <span class="attr">zIndex</span>: <span class="number">100</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ul>
<li>Platform.OS &#x3D;&#x3D;&#x3D; ‘web’ ? ‘fixed’ : ‘absolute’<br>这行代码让底部导航栏在 Web 端用 CSS 的 position: fixed，在原生端用 position: absolute。</li>
<li><code>fixed</code> 能让导航栏在 Web 页面滚动时始终固定在底部，不会被内容遮挡或随内容滚动。</li>
<li>其他属性（如 left: 0, right: 0, bottom: 0）确保导航栏横跨底部。</li>
</ul>
<h2 id="3-2内容区域在web端无法滚动"><a href="#3-2内容区域在web端无法滚动" class="headerlink" title="3.2内容区域在web端无法滚动"></a>3.2内容区域在web端无法滚动</h2><p>MasonryList 在 web 端无法滚动，主要原因是底部导航栏用 position: fixed，而内容区的父容器高度被“撑满”，导致内容溢出时不会出现滚动条。</p>
<p>解决办法：</p>
<ol>
<li><strong>让内容区高度减去底部导航栏高度</strong>在 web 端，内容区需要用 height: calc(100vh - 56px)，这样内容区才会出现滚动条。React Native 的 StyleSheet 不支持 <code>calc</code>，但可以用内联样式+平台判断实现。</li>
<li><strong>MasonryList 不要设置 flex: 1，而是让外层 View 控制高度</strong></li>
</ol>
<p>这样 MasonryList 会自动填满内容区并可滚动。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Platform</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="comment">// ...existing code...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 内容区域：真正瀑布流 */</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="title class_">View</span></span><br><span class="line">  style=&#123;</span><br><span class="line">    <span class="title class_">Platform</span>.<span class="property">OS</span> === <span class="string">&#x27;web&#x27;</span></span><br><span class="line">      ? &#123;</span><br><span class="line">          <span class="attr">height</span>: <span class="string">&#x27;calc(100vh - 56px)&#x27;</span>, <span class="comment">// 56px为底部tabBar高度</span></span><br><span class="line">          <span class="attr">overflowY</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      : &#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">minHeight</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">MasonryList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">data</span>=<span class="string">&#123;posts&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">keyExtractor</span>=<span class="string">&#123;(item:</span> <span class="attr">Post</span>) =&gt;</span> item.id.toString()&#125;</span></span><br><span class="line"><span class="language-xml">    numColumns=&#123;2&#125;</span></span><br><span class="line"><span class="language-xml">    contentContainerStyle=&#123;styles.content&#125;</span></span><br><span class="line"><span class="language-xml">    showsVerticalScrollIndicator=&#123;true&#125;</span></span><br><span class="line"><span class="language-xml">    renderItem=&#123;(&#123; item &#125;: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">      if (item.images &amp;&amp; item.images.length &gt; 0) &#123;</span></span><br><span class="line"><span class="language-xml">        return (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;[styles.card,</span> &#123; <span class="attr">width:</span> <span class="attr">CARD_WIDTH</span>, <span class="attr">alignSelf:</span> &#x27;<span class="attr">flex-start</span>&#x27; &#125;]&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.cardTitle&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.cardSummary&#125;</span>&gt;</span>&#123;item.summary&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">flexDirection:</span> &#x27;<span class="attr">row</span>&#x27;, <span class="attr">flexWrap:</span> &#x27;<span class="attr">wrap</span>&#x27;, <span class="attr">marginTop:</span> <span class="attr">8</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123;item.images.map((uri: string, idx: number) =&gt; (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Image</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">key</span>=<span class="string">&#123;idx&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">source</span>=<span class="string">&#123;&#123;</span> <span class="attr">uri</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">80</span>, <span class="attr">height:</span> <span class="attr">80</span>, <span class="attr">borderRadius:</span> <span class="attr">8</span>, <span class="attr">marginRight:</span> <span class="attr">8</span>, <span class="attr">marginBottom:</span> <span class="attr">8</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                /&gt;</span></span></span><br><span class="line"><span class="language-xml">              ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        );</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">      return (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;[styles.card,</span> &#123; <span class="attr">width:</span> <span class="attr">CARD_WIDTH</span>, <span class="attr">alignSelf:</span> &#x27;<span class="attr">flex-start</span>&#x27; &#125;]&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.cardTitle&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.cardSummary&#125;</span>&gt;</span>&#123;item.summary&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      );</span></span><br><span class="line"><span class="language-xml">    &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  /&gt;</span></span><br><span class="line">&lt;/<span class="title class_">View</span>&gt;</span><br></pre></td></tr></table></figure>
<p>是不是感觉跨端开发要考虑的问题还挺多的呢</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://ggbond11.github.io">ggbond11</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ggbond11.github.io/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/">https://ggbond11.github.io/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ggbond11.github.io" target="_blank">ggbond个人博客</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/images/ggbond.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/19/%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0-%E7%82%B9%E5%87%BB%E9%A6%96%E9%A1%B5%E5%88%B7%E6%96%B0/" title="下拉刷新/点击首页刷新"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">下拉刷新/点击首页刷新</div></div><div class="info-2"><div class="info-item-1">下拉刷新&#x2F;点击首页刷新 1.shuffle函数模拟刷新后的状态项目中通过随机打乱帖子的顺序来模拟刷新后的状态 12345678function shuffle(arr: any[]) &#123;    const a = arr.slice();    for (let i = a.length - 1; i &gt; 0; i--) &#123;      const j = Math.floor(Math.random() * (i + 1));      [a[i], a[j]] = [a[j], a[i]];    &#125;    return a;  &#125; 2.下拉刷新实现@react-native-seoul&#x2F;masonry-list 是基于 React Native 的 ScrollView 扩展实现的，它的设计目标是提供类似于 FlatList 的开发体验。正如搜索结果中提到的：”Current MasonryList extends ScrollView and can pass down its props.”。看到的下拉旋转...</div></div></div></a><a class="pagination-related" href="/2025/09/18/%E7%99%BB%E5%BD%95-%E6%B3%A8%E5%86%8C%E9%A1%B5/" title="登录/注册页"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">登录/注册页</div></div><div class="info-2"><div class="info-item-1">登录&#x2F;注册页 1.AsyncStorage存储用户信息AsyncStorage是 React Native 提供的一个本地键值对存储方案，类似于浏览器的 localStorage。它可以将数据以字符串形式持久化在设备本地。 安装：npm install @react-native-async-storage/async-storage 在你的 userStorage.ts 里，用户信息存储的实现方式如下：  注册时  先通过 getAllUsers() 读取所有已注册用户（从 users 这个 key 里取出 JSON 字符串并解析为数组）。 检查新用户的邮箱或手机号是否已存在。 如果没有重复，把新用户对象 push 到数组，再用 AsyncStorage.setItem(‘users’, JSON.stringify(users)) 存回本地。   登录时  通过 getAllUsers() 读取所有用户。 查找账号（邮箱或手机号）和密码都匹配的用户，找到则登录成功。   数据结构  所有用户信息都存储在 users 这个 key 下，是一个用户对象数组，内容被序列化...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/ggbond.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ggbond11</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ggbond11"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%8F%8C%E5%88%97%E7%80%91%E5%B8%83%E6%B5%81%E5%B8%83%E5%B1%80"><span class="toc-number">1.</span> <span class="toc-text">1.双列瀑布流布局</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1MasonryList-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1MasonryList 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E5%9C%A8%E6%9C%AC%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E8%BF%90%E7%94%A8"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.2在本项目中的运用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%8F%91%E5%B8%83%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.</span> <span class="toc-text">2.发布页面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%E5%90%91%E9%A6%96%E9%A1%B5%E4%BC%A0%E9%80%92%E5%B8%96%E5%AD%90%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.</span> <span class="toc-text">2.1向首页传递帖子数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E5%8F%91%E5%B8%96%E6%94%AF%E6%8C%81%E6%9C%AC%E5%9C%B0%E7%9B%B8%E5%86%8C%E5%92%8C%E6%8B%8D%E7%85%A7%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0"><span class="toc-number">2.2.</span> <span class="toc-text">2.2发帖支持本地相册和拍照图片上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="toc-number">2.2.1.</span> <span class="toc-text">主要功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%9C%AC%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">在本项目中的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E8%AF%B4%E6%98%8E"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">具体说明</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95"><span class="toc-number">3.</span> <span class="toc-text">3.踩坑记录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1web%E7%AB%AF%E5%BA%95%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F%E6%B6%88%E5%A4%B1"><span class="toc-number">3.1.</span> <span class="toc-text">3.1web端底部导航栏消失</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E5%86%85%E5%AE%B9%E5%8C%BA%E5%9F%9F%E5%9C%A8web%E7%AB%AF%E6%97%A0%E6%B3%95%E6%BB%9A%E5%8A%A8"><span class="toc-number">3.2.</span> <span class="toc-text">3.2内容区域在web端无法滚动</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/19/%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0-%E7%82%B9%E5%87%BB%E9%A6%96%E9%A1%B5%E5%88%B7%E6%96%B0/" title="下拉刷新/点击首页刷新">下拉刷新/点击首页刷新</a><time datetime="2025-09-19T07:26:31.000Z" title="发表于 2025-09-19 15:26:31">2025-09-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/18/%E9%A6%96%E9%A1%B5-%E5%8F%91%E5%B8%83%E9%A1%B5/" title="首页/发布页">首页/发布页</a><time datetime="2025-09-18T08:02:44.000Z" title="发表于 2025-09-18 16:02:44">2025-09-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/18/%E7%99%BB%E5%BD%95-%E6%B3%A8%E5%86%8C%E9%A1%B5/" title="登录/注册页">登录/注册页</a><time datetime="2025-09-18T08:00:43.000Z" title="发表于 2025-09-18 16:00:43">2025-09-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/17/%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="项目环境搭建">项目环境搭建</a><time datetime="2025-09-17T14:39:46.000Z" title="发表于 2025-09-17 22:39:46">2025-09-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/17/React-Native%E7%AE%80%E4%BB%8B/" title="React Native简介">React Native简介</a><time datetime="2025-09-17T14:38:01.000Z" title="发表于 2025-09-17 22:38:01">2025-09-17</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By ggbond11</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.0</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>